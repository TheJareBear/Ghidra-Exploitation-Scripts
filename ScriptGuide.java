//INTRO SCRIPTING GUIDE
//@author Jarod Keene
//@category Patcher
//@keybinding
//@menupath
//@toolbar

import java.util.ArrayList;
import java.util.List;

import ghidra.app.plugin.assembler.Assembler;
import ghidra.app.plugin.assembler.Assemblers;
import ghidra.app.script.GhidraScript;

public class ScriptGuide extends GhidraScript {

	@Override
	protected void run() throws Exception {
		// THIS DEMO GUIDE WILL HAVE A NUMBER OF FUNCTIONS AND GIVEN VARIABLES THAT WILL BE USEFUL IN YOUR SCRIPT DEVELOPMENT

		// SECTION 1: SCRIPT GIVENS
		// WITHIN GHIDRA SCRIPTS, AND OFTEN WITHIN GHIDRA PLUGINS, THERE ARE A NUMBER OF GIVEN VARIABLES THAT CAN HELP OUT
		
		// currentProgram is one of these variables
		println("0x" + currentProgram.getImageBase());
		// currentProgram IS OF TYPE Program AND GIVES THE USER AN OBJECT THAT CONTAINS INFORMATION ABOUT THE RUNNING PROGRAM
		// THIS VARIABLE CAN BE USED TO ADJUST MEMORY, START TRANSACTIONS, VIEW INSTRUCTIONS, AND MUCH MORE

		// currentAddress IS ANOTHER VARIABLE OF INTEREST
		println("0x" + currentAddress);
		// currentAddress GIVES THE PROGRAMMER INSIGHT TO WHERE WITHIN LOADED MEMORY THE USER IS SITTING
		// (WHERE THE CURSOR IS SELECTING CODE OR LISTING)

		// THERE ARE MANY OTHER GIVENS THAT DEVELOPERS CAN UTILIZE WITHIN THE GHIDRA SCRIPT CLASS (BELOW IS A SHORT LIST)
		// currentAddress, currentHighlight, currentLocation, currentProgram, currentSelection, etc.


		// SECTION 2: FLAT PROGRAM API
		// GHIDRA SCRIPTS ALSO OFFER MANY FUNCTIONS THAT CAN BE CALLED TO COMPLETE DESIRED TASKS, SOME WILL BE SHOWN IN THIS SECTION

		// getBytes ALLOWS USERS TO GET BYTES AT A GIVEN MEMORY LOCATION
		byte[] byteArray = new byte[100];		
		currentProgram.getMemory().getBytes(currentAddress, byteArray, 0, 100);
		// setBytes ALLOWS USERS TO SET BYTES AT A GIVEN MEMORY LOCATION (MAKE SURE MEMORY IS CLEARED OF LISTINGS BEFORE)
		clearListing(currentAddress, currentAddress.add(byteArray.length-1));
		setBytes(currentAddress, byteArray);
	}
}
